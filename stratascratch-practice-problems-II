/* stratascratch.com Practice Problems II*/

/*Find the most profitable company from the financial sector. Output the result along with the continent.*/
/*forbes_global_2010_2014 Table:
company:        varchar
sector:         varchar
industry:       varchar
continent:      varchar
country:        varchar
marketvalue:    float
sales:          float
profits:        float
assets:         float
rank:           int
forbeswebpage:  varchar */

SELECT company, continent
FROM forbes_global_2010_2014
WHERE sector = 'Financials'
HAVING MAX(profits);


/*Count the number of companies in the Information Technology sector in each country.
Output the result along with the corresponding country name.
Order the result based on the number of companies in the descending order./*
/*forbes_global_2010_2014 Table:
company:        varchar
sector:         varchar
industry:       varchar
continent:      varchar
country:        varchar
marketvalue:    float
sales:          float
profits:        float
assets:         float
rank:           int
forbeswebpage:  varchar */

SELECT country, COUNT(sector) AS num_of_companies
FROM forbes_global_2010_2014
WHERE sector = 'Information Technology'
GROUP BY country
ORDER BY num_of_companies DESC;


/*Find the average profit for major banks.*/
/*forbes_global_2010_2014 Table:
company:        varchar
sector:         varchar
industry:       varchar
continent:      varchar
country:        varchar
marketvalue:    float
sales:          float
profits:        float
assets:         float
rank:           int
forbeswebpage:  varchar */

SELECT AVG(profits) AS average_profit
FROM forbes_global_2010_2014
WHERE industry = "Major Banks";


/* Find the total cost of each customer's orders. Output customer's id, first name, and the total order cost. 
Order records by customer's first name alphabetically.*/
/* customers Table:
id:            int
first_name:    varchar
last_name:     varchar
city:          varchar
address:       varchar
phone_number:  varchar
-------------------------
orders Table:
id:                int
cust_id:           int
order_date:        datetime
order_details:     varchar
total_order_cost:  int */

SELECT customers.id, customers.first_name, SUM(orders.total_order_cost) AS total_cost
FROM customers
JOIN orders
ON customers.id = orders.cust_id
GROUP BY customers.id
ORDER BY customers.first_name ASC;
